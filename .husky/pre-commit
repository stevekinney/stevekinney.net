set -e

# Collect staged Markdown files under content
STAGED_FILES="$(git diff --cached --name-only --diff-filter=ACMRTUXB -- 'content/**/*.md')"

# Audit frontmatter for staged course files first
COURSE_FILES="$(git diff --cached --name-only --diff-filter=ACMRTUXB -- 'content/courses/**/*.md')"
if [ -n "$COURSE_FILES" ]; then
  echo "Auditing frontmatter (title/description) for staged course files..."
  bun run scripts/audit-courses-frontmatter.ts $COURSE_FILES
  git add $COURSE_FILES
fi

npx lint-staged
